# NVST Command Reference

Full reference for the `nvst` CLI commands. See [QUICK_USE.md](QUICK_USE.md) for common workflows.

## Lifecycle

| Command | Description |
|---------|-------------|
| `nvst init` | Initialize toolkit files in the current directory (copies scaffold from package) |
| `nvst destroy [--clean]` | Remove files generated by nvst. Use `--clean` to also remove `.agents/flow/archived` |
| `nvst start iteration` | Start a new iteration (archives previous if exists, resets state) |

## Define Phase

| Command | Description |
|---------|-------------|
| `nvst define requirement --agent <provider> [--force]` | Create requirement document via agent |
| `nvst refine requirement --agent <provider> [--challenge] [--force]` | Refine requirement document (editor or challenger mode) |
| `nvst approve requirement` | Mark requirement definition as approved |

## Prototype Phase

| Command | Description |
|---------|-------------|
| `nvst create project-context --agent <provider> [--mode strict\|yolo] [--force]` | Generate or update PROJECT_CONTEXT.md via agent |
| `nvst approve project-context` | Mark project context as approved |
| `nvst create prototype --agent <provider> [--iterations <N>] [--retry-on-fail <N>] [--stop-on-critical]` | Iterative agent-driven implementation of user stories |
| `nvst define test-plan --agent <provider> [--force]` | Generate test plan document for current iteration |
| `nvst refine test-plan --agent <provider> [--challenge] [--force]` | Refine test plan document |
| `nvst approve test-plan` | Mark test plan as approved and generate structured TP JSON |
| `nvst execute test-plan --agent <provider> [--force]` | Execute approved structured test-plan JSON via agent |
| `nvst create issue --agent <provider>` | Create issues interactively via agent |
| `nvst create issue --test-execution-report` | Derive issues from test execution results |
| `nvst execute automated-fix --agent <provider> [--iterations <N>] [--retry-on-fail <N>]` | Attempt automated fixes for open issues |
| `nvst execute manual-fix --agent <provider>` | Find manual-fix issues and confirm execution |
| `nvst approve prototype` | Stage and commit all pending changes for current iteration |

## Refactor Phase

| Command | Description |
|---------|-------------|
| `nvst define refactor-plan --agent <provider> [--force]` | Create refactor plan document via agent |
| `nvst refine refactor-plan --agent <provider> [--challenge] [--force]` | Refine refactor plan document |
| `nvst approve refactor-plan` | Mark refactor plan as approved and generate TECHNICAL_DEBT.md |
| `nvst execute refactor --agent <provider> [--force]` | Execute approved refactor items via agent |

## Flow & Utilities

| Command | Description |
|---------|-------------|
| `nvst flow [--agent <provider>] [--force]` | Run the next pending flow step(s) until an approval gate or completion |
| `nvst write-json --schema <name> --out <path> [--data '<json>']` | Write a schema-validated JSON file (payload via --data or stdin) |

## Global Options

| Option | Description |
|--------|-------------|
| `--agent <provider>` | Agent provider: `claude`, `codex`, `gemini`, `cursor` |
| `--mode strict\|yolo` | Create mode for project-context (strict = questions, yolo = minimal prompts) |
| `--iterations <N>` | Maximum prototype/fix passes (integer >= 1) |
| `--retry-on-fail <N>` | Retry attempts per failed story (integer >= 0) |
| `--stop-on-critical` | Stop execution after critical failures |
| `--force` | Bypass flow guardrail confirmation |
| `--challenge` | Run refine in challenger mode (critical reviewer) |
| `--clean` | With destroy: also removes .agents/flow/archived |
| `-h`, `--help` | Show help message |
| `-v`, `--version` | Print version and exit |
