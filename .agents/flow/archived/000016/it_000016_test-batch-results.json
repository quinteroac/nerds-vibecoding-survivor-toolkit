[
  {"testCaseId": "TC-US001-01", "status": "passed", "evidence": "cli.ts imports runApprovePrototype from './commands/approve-prototype' (L7) and dispatches subcommand 'prototype' with await runApprovePrototype({ force }) (L416-418).", "notes": "Verified by code inspection."},
  {"testCaseId": "TC-US001-02", "status": "passed", "evidence": "approve-prototype.ts runStageAndCommitFn runs 'git add -A && git commit -m ${message}' (L38-39); commitMessage = 'feat: approve prototype it_${state.current_iteration}' (L84).", "notes": "Verified by code inspection."},
  {"testCaseId": "TC-US001-03", "status": "passed", "evidence": "When !statusResult.stdout, handler calls logFn('No pending changes to commit; working tree is clean.') and return without committing (L107-110). Unit test in approve-prototype.test.ts L135-164 asserts same.", "notes": "Verified by code inspection and existing unit test."},
  {"testCaseId": "TC-US001-04", "status": "failed", "evidence": "On commit failure handler throws 'Failed to create prototype approval commit: ${commitResult.stderr}' (L114-116). Requirement expects error to include 'Pre-commit hook failed:\\n' plus hook output; implementation does not prepend that prefix.", "notes": "Code does not format pre-commit failure message as specified."},
  {"testCaseId": "TC-US001-05", "status": "skipped", "evidence": "bun run tsc --noEmit / bunx tsc --noEmit could not be executed in session (command rejected).", "notes": "Typecheck not run; project has tsconfig.json and strict TypeScript."},
  {"testCaseId": "TC-US002-01", "status": "passed", "evidence": "approve-prototype.ts runPushFn runs 'git push -u origin ${branch}' (L60-61); branch from runCurrentBranchFn; push invoked after successful commit (L126).", "notes": "Verified by code inspection."},
  {"testCaseId": "TC-US002-02", "status": "passed", "evidence": "On push failure handler sets process.exitCode = 1 (L129), throws descriptive Error (L130-132); writeState is called only after push success (L134-137), so state.json is not updated on push failure.", "notes": "Verified by code inspection; unit test L168-201 asserts push failure behaviour."},
  {"testCaseId": "TC-US002-03", "status": "skipped", "evidence": "Typecheck command could not be executed in session.", "notes": "Same as TC-US001-05."},
  {"testCaseId": "TC-US003-01", "status": "passed", "evidence": "create-prototype.ts: when gh available, createPullRequestFn runs 'gh pr create --title ${title} --body ${body}' (L70); prTitle = 'feat: prototype it_${iteration}', prBody = 'Prototype for iteration it_${iteration}' (L478-479).", "notes": "Verified by code inspection; PR creation is in create-prototype flow."},
  {"testCaseId": "TC-US003-02", "status": "passed", "evidence": "create-prototype.ts: when !ghAvailable, logFn('gh CLI not found â€” skipping PR creation') (L477), no throw; execution continues and exits successfully.", "notes": "Verified by code inspection."},
  {"testCaseId": "TC-US003-03", "status": "passed", "evidence": "create-prototype.ts: state is written before gh block (L464-466); on prResult.exitCode !== 0, warnFn('gh pr create failed (non-fatal)' + suffix) (L484); state already updated.", "notes": "Verified by code inspection."},
  {"testCaseId": "TC-US003-04", "status": "skipped", "evidence": "Typecheck command could not be executed in session.", "notes": "Same as TC-US001-05."},
  {"testCaseId": "TC-US004-01", "status": "passed", "evidence": "After successful commit and push, state.phases.prototype.prototype_approved = true, state.last_updated = nowFn().toISOString(), writeState called (L134-137).", "notes": "Verified by code inspection and unit test L114-134."},
  {"testCaseId": "TC-US004-02", "status": "passed", "evidence": "When state.phases.prototype.prototype_approved is true, handler throws Error('Cannot approve prototype: phases.prototype.prototype_approved is already true.') (L94-98); cli catch sets process.exitCode = 1.", "notes": "Verified by code inspection; unit test L202-220."},
  {"testCaseId": "TC-US004-03", "status": "passed", "evidence": "assertGuardrail(state, currentPhase !== 'prototype', 'Cannot approve prototype: current_phase must be...') called at start (L87-92); when phase not 'prototype', guardrail throws or prompts.", "notes": "Verified by code inspection; unit test L222-240."},
  {"testCaseId": "TC-US004-04", "status": "passed", "evidence": "assertGuardrail called at beginning of runApprovePrototype with (state, currentPhase !== 'prototype', message, { force }) (L87-92).", "notes": "Verified by code inspection."},
  {"testCaseId": "TC-US004-05", "status": "passed", "evidence": "approve-prototype.ts sets process.exitCode = 1 only on push failure (L129); other errors throw. cli.ts has no process.exit(); main().catch sets process.exitCode = 1. Grep: no process.exit() in src.", "notes": "Verified by code inspection."},
  {"testCaseId": "TC-US004-06", "status": "skipped", "evidence": "Typecheck command could not be executed in session.", "notes": "Same as TC-US001-05."}
]
